<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>

<body>
    <div class="popup-ksyun">倒计时 ：
        <span class="popup-time">5</span>
    </div>
    <p></p>
    <script type="text/javascript" src="js/jquery-1.11.1.min.js"></script>
    <script>
    $(function() {
        // // demo01：rewrite by object
        //    var ksyun = {
        //        t: 5,
        //        clock: function() {
        //            var that = this;
        //            if (that.t > 0) {
        //            	that.setClock();
        //            } else if (this.t === 0) {
        //                clearTimeout(that.setClock);
        //            }
        //        },
        //        setClock: function() {
        //        	var that = this;
        //            setTimeout(function() {
        //                that.t = that.t - 1;
        //                // console.log(that.t);
        //                $('.popup-time').text(that.t);
        //                that.clock();
        //            }, 1000);
        //        }

        //    }
        //    ksyun.clock();
        // demo02：rewrite by closure
        var ksyun = {
            clock: function() {
                var t = 5;
                return {
                    myClock: function() {
                        if (t > 0) {
                            this.setClock();
                        } else if (t === 0) {
                            clearTimeout(this.setClock);
                        }
                    },
                    setClock: function() {
                    	var that = this;
                        setTimeout(function() {
                            t = t - 1;
                            $('.popup-time').text(t);
                            that.myClock();
                        }, 1000);
                    }
                } //return
            },
        }
        ksyun.clock().myClock();
    })
    
    </script>
</body>

</html>
